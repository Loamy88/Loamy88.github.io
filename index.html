<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Car Cockpit Game</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.1/build/three.min.js"></script>
<script>
  /* scene setup */
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0xa0c4ff);

  const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  const renderer = new THREE.WebGLRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  /* lighting */
  const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 1);
  hemiLight.position.set(0, 20, 0);
  scene.add(hemiLight);

  const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
  dirLight.position.set(5, 10, 7.5);
  scene.add(dirLight);

  /* ground */
  const groundGeo = new THREE.PlaneGeometry(1000, 1000);
  const groundMat = new THREE.MeshStandardMaterial({ color: 0x4CAF50 });
  const ground = new THREE.Mesh(groundGeo, groundMat);
  ground.rotation.x = -Math.PI / 2;
  scene.add(ground);

  /* cockpit */
  const cockpit = new THREE.Group();

  const dashGeo = new THREE.BoxGeometry(2.5, 0.5, 1);
  const dashMat = new THREE.MeshStandardMaterial({ color: 0x333333 });
  const dashboard = new THREE.Mesh(dashGeo, dashMat);
  dashboard.position.set(0, -0.6, -1.5);
  cockpit.add(dashboard);

  const wheelGroup = new THREE.Group();
  const wheelGeometry = new THREE.TorusGeometry(0.4, 0.05, 16, 100);
  const wheelMaterial = new THREE.MeshStandardMaterial({ color: 0x000000 });
  const wheel = new THREE.Mesh(wheelGeometry, wheelMaterial);
  wheel.rotation.y = Math.PI;
  wheelGroup.add(wheel);

  const wheelSpokesGeo = new THREE.CylinderGeometry(0.03, 0.03, 0.4, 12);
  const spoke1 = new THREE.Mesh(wheelSpokesGeo, wheelMaterial);
  spoke1.rotation.z = Math.PI / 2;
  wheelGroup.add(spoke1);

  const center = new THREE.CylinderGeometry(0.1, 0.1, 0.05, 32);
  const centerMesh = new THREE.Mesh(center, new THREE.MeshStandardMaterial({ color: 0x888888 }));
  centerMesh.rotation.x = Math.PI / 2;
  wheelGroup.add(centerMesh);

  wheelGroup.position.set(0, -0.3, -0.6);
  cockpit.add(wheelGroup);

  const frameMaterial = new THREE.MeshStandardMaterial({ color: 0x222222 });
  const frameThickness = 0.1;
  const frameWidth = 3.5;
  const frameHeight = 2;
  const frameZ = -1.1;

  const topFrame = new THREE.Mesh(new THREE.BoxGeometry(frameWidth, frameThickness, frameThickness), frameMaterial);
  topFrame.position.set(0, frameHeight / 2, frameZ);
  cockpit.add(topFrame);

  const bottomFrame = new THREE.Mesh(new THREE.BoxGeometry(frameWidth, frameThickness, frameThickness), frameMaterial);
  bottomFrame.position.set(0, -frameHeight / 2, frameZ);
  cockpit.add(bottomFrame);

  const leftFrame = new THREE.Mesh(new THREE.BoxGeometry(frameThickness, frameHeight, frameThickness), frameMaterial);
  leftFrame.position.set(-frameWidth / 2 + frameThickness / 2, 0, frameZ);
  cockpit.add(leftFrame);

  const rightFrame = new THREE.Mesh(new THREE.BoxGeometry(frameThickness, frameHeight, frameThickness), frameMaterial);
  rightFrame.position.set(frameWidth / 2 - frameThickness / 2, 0, frameZ);
  cockpit.add(rightFrame);

  const overlay = document.createElement('div');
  overlay.style.position = 'absolute';
  overlay.style.top = 0;
  overlay.style.left = 0;
  overlay.style.width = '100%';
  overlay.style.height = '100%';
  overlay.style.pointerEvents = 'none';
  overlay.style.zIndex = 10;
  overlay.innerHTML = `
    <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
      <path d="M0,0 Q50,80 100,0" fill="black" opacity="0.4" transform="translate(0,0) scale(${window.innerWidth/100}, 1)"/>
    </svg>`;
  document.body.appendChild(overlay);

  camera.add(cockpit);
  camera.position.set(0, 1.5, 0);
  scene.add(camera);

  /* movement */
  let angle = 0;
  let steering = 0;
  let speed = 0;
  let keys = {};

  const maxForwardSpeed = 0.3;
  const acceleration = 0.004;
  const braking = 0.005;
  const reverseSpeed = -0.15;
  const friction = 0.98;

  window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
  window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

  function animate() {
    requestAnimationFrame(animate);

    if (keys['a']) steering += 0.0015;
    else if (keys['d']) steering -= 0.0015;
    else steering *= 0.9;

    if (keys['w']) {
      if (speed < maxForwardSpeed) speed += acceleration;
    } else if (keys['s']) {
      if (speed > 0) speed -= braking;
      else speed = reverseSpeed;
    } else {
      speed *= friction;
    }

    angle += steering * speed * 3;
    camera.rotation.y = angle;

    const dx = Math.sin(angle) * speed;
    const dz = Math.cos(angle) * speed;
    camera.position.x += dx;
    camera.position.z += dz;

    wheelGroup.rotation.z = steering * 10; /* turn more, realistic */

    renderer.render(scene, camera);
  }

  animate();
</script>
</body>
</html>
